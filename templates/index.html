<!DOCTYPE html>
<html>
<head>
    <title>Generic XML Grouper</title> 
</head>
<body>
    <h2>Upload XML File</h2>
    <form action="/upload" method="post" enctype="multipart/form-data">
        <input type="file" name="file" accept=".xml" required>
        <button type="submit">Upload & Preview</button>
    </form>

    {% if tags and not keys %}
    <h2>Select Tag to Group</h2>
    <form action="/select_key" method="post">
        <select name="selected_tag" required>
            {% for tag in tags %}
                <option value="{{ tag }}" {% if tag==selected_tag %}selected{% endif %}>{{ tag }}</option>
            {% endfor %}
        </select>
        <input type="hidden" name="xml_content" value="{{ xml_preview }}">
        <button type="submit">Next: Select Key</button>
    </form>
    {% endif %}

    {% if keys %}
    <h2>Select Key for Grouping "{{ selected_tag }}"</h2>
    <form action="/group" method="post">
        <select name="selected_key" required>
            {% for key in keys %}
                <option value="{{ key }}" {% if key==selected_key %}selected{% endif %}>{{ key }}</option>
            {% endfor %}
        </select>
        <input type="hidden" name="xml_content" value="{{ xml_preview }}">
        <input type="hidden" name="selected_tag" value="{{ selected_tag }}">
        <button type="submit">Group</button>
    </form>
    {% endif %}

    {% if xml_preview %}
    <h2>XML Preview</h2>
    <form action="/download" method="post">
        <textarea name="file_content" rows="25" cols="100">{{ xml_preview }}</textarea><br><br>
        <button type="submit">Download Grouped XML</button>
    </form>
    {% endif %}
</body>
</html>
